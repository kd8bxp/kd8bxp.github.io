<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../../../img/favicon.ico">
        <title>I2C C Library - Random Wire!</title>
        <link href="../../../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../../../../..">Random Wire!</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../../../../..">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../blink/blink/">Blink</a>
</li>
                                    
<li >
    <a href="../../../../document/">Document Projects</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">HiCat Livera Docs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../livera/">Documentation</a>
</li>
            
<li >
    <a href="../../../../livera/api/">API Guide</a>
</li>
            
<li >
    <a href="../../../../livera/robotAssemGuide/">Robot Assembily Guide</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Raspberry PI</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../RaspberryPi/1.54inTFTGameScreen/tutorial/">1.54" TFT Touch Screen</a>
</li>
            
<li >
    <a href="../../../../RaspberryPi/OpenCV/opencv/">Raspberry PI Zero W OpenCV</a>
</li>
            
<li >
    <a href="../../../../RaspberryPi/restrictedshell/">Restricted Shell</a>
</li>
            
<li >
    <a href="../../../../RaspberryPi/jupyter/">Setup Jupyter Notebook</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">FPGA Boards</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../ArduinoMKRVidor4000_fpga_board/">Arduino MKR Vidor 4000</a>
</li>
            
<li >
    <a href="../../../../mojov3fpga/">Mojo V3 FPGA</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../../../TI/resources/">TI Launchpad Resources</a>
</li>
                                    
<li >
    <a href="../../../../ESP-MESH/ESP-MESH/">ESP-MESH Board</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">MQTT Services</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../MQTT-Services/brokers/">Brokers</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Tessel</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../Tessel/readme/">Resources</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../../../syncthing/">Syncthing</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Cozmo SDK</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../CozmoSDKDocs/CozmoInfo/">Cozmo Information</a>
</li>
            
<li >
    <a href="../../../../CozmoSDKDocs/SDK/adb/">ADB</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Sipeed Maix Bit</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../SipeedMaixBit/info/">General Information</a>
</li>
            
<li >
    <a href="../../../../SipeedMaixBit/M5StickV/">M5StickV</a>
</li>
            
<li >
    <a href="../../../../SipeedMaixBit/Sipeed_Maixduino/">Sipeed Maixduino</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../../../azuresphere/">Azure Sphere General Information</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Projects <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">Arduino</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/arduino/chatterbot/">Chatter Bot</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-4x4-keypad-matrix-rotary-encoder/">4x4 Keypad Matrix</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-arduino-vga-out/">Arduino VGA</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-bmp180-digital-barometric-pressur/">BMP180 Sensor</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-fs1000a-433mhz-transmitters/">FS1000a 433mhz Transmitters</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-hc-05-bluetooth-device/">HC-05 Bluetooth</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-magnetic-reed-switch-water-sensor/">Magnetic Reed Switch Water Sensor</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-mifare-rfid-reader-rc522/">Mifare RFID reader RC522</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-nokia-5110-lcd/">Nokia 5110 LCD</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-pin-control-over-ethernet-oled-de/">Pin Control over Ethernet w/OLED</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-skynet-im/">Skynet IM</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/arduino-project-the-spo-512-speech-synthesizer/">SPO-512 Speech Synthesizer</a>
</li>
            
<li >
    <a href="../../../../../projects/arduino/QVGA-DISPLAY/QVGA-Display2/">QVGA Display</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">ESP8266</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/esp8266/">Temp</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">ESP32</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/esp32/">Temp</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">TI LaunchPad</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/TILaunchPad/ti-multi-task/">TI Launchpad MS432 Multi-Task Demo</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Raspberry PI</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/RaspberryPI/services/">General Information</a>
</li>
            
<li >
    <a href="../../../../../projects/RaspberryPI/">PIDuino Setup</a>
</li>
            
<li >
    <a href="../../../../../projects/RaspberryPI/tunnelservices/">Raspberry PI Tunnel Services</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Other Projects</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/other/project-hot-wheels-10-525ghz-radar-gun/">Hot Wheels 10.524Ghz Radar Gun</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Robot Projects <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">Robot Chassis Kits</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/robot/chassis-kits/Actobotics/">Actobotics</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Hero Jr Robot</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/robot/herojr/">Hero Jr Project</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Hero Jr Star Wars Day Dec 2015</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/robot/HeroJr-StarWarsDay/">General Info</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/HeroJr-StarWarsDay/Demo/">Midpointe Library Dec 12 Demo</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/HeroJr-StarWarsDay/Outline_Script_for_Star_Wars_Day_Hero_Jr/">Outline of Program</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/HeroJr-StarWarsDay/Star_Wars_Hero_Jr_Punch_List/">Punch List</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/HeroJr-StarWarsDay/pictures_from_Star_Wars_Day/">Pictures</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">2W & 4W Robots</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../robots/robotstart/">Getting Started</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/L298MotorDrive/">L298 Motor Driver</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/BittyBot/">BittyBot</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/BittyBot2Library/">BittyBot 2</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/CompactRoverLibrary/">Compact Rover</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">SunFounder Robots</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/robot/SunFounder_PISmartCar/">PISmartCar</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../../../../projects/robot/RobotNavigationusingRFID/">Robot Indoor Navigation using RFID</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Anki Vector</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/robot/Vector_Commands/">Command List</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../../../../projects/InternetControlledRobots/">Internet Controlled Robots</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Other Robot Projects (Not Mine)</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../projects/robot/anki_vector_cozmo/">Anki Vector and Cozmo</a>
</li>
            
<li >
    <a href="../../../../../projects/robot/Karotz/">Karotz</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Ham Radio <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../../hamradio/hotspot/">MMDVM Hotspot Info</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../../../../comingsoon/">Sherlock Holmes</a>
</li>
                                    
<li >
    <a href="../../../../../other/pp/">Pen and Paper RPG & Heroclix Games</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">Movies/TV Shows & OTR</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../comingsoon/">X Minus One</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">The Orville</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../other/theorville/comics/">Comics</a>
</li>
            
<li >
    <a href="../../../../../comingsoon/">Planetary Union Central</a>
</li>
            
<li >
    <a href="../../../../../other/theorville/wiki/">Fan Wiki</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../../../../comingsoon/">Forbidden Planet (C-57D)</a>
</li>
            
<li >
    <a href="../../../../../comingsoon/">Batman (1966)</a>
</li>
            
<li >
    <a href="../../../../../other/greenhornet/greenhornet/">Green Hornet</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">DC Comics</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../comingsoon/">Comics</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">TV Shows</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../comingsoon/">The Flash</a>
</li>
            
<li >
    <a href="../../../../../comingsoon/">Arrow</a>
</li>
            
<li >
    <a href="../../../../../comingsoon/">Supergirl</a>
</li>
            
<li >
    <a href="../../../../../comingsoon/">Legends of Tomorrow</a>
</li>
            
<li >
    <a href="../../../../../comingsoon/">Batwoman</a>
</li>
            
<li >
    <a href="../../../../../comingsoon/">Constantine</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../../../../comingsoon/">Movies</a>
</li>
            
<li >
    <a href="../../../../../comingsoon/">Egyptian Gods</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="../../../../../comingsoon/">Lord of the Rings</a>
</li>
                                    
<li >
    <a href="../../../../../comingsoon/">Noris Mythology</a>
</li>
                                    
<li >
    <a href="../../../../../other/greek/">Greek Mythology</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">More Stuff</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../../../../other/stuff/">Stuff</a>
</li>
            
<li >
    <a href="../../../../../other/CPU_Cryptocurrancy/">Crptocurrancy</a>
</li>
            
<li >
    <a href="../../../../../other/InteractiveFiction/">Interactive Fiction</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../../../../about/">About Me</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#i2c-c-library">I2C C Library</a></li>
        <li class="main "><a href="#linux-and-i2c">Linux and I2C</a></li>
        <li class="main "><a href="#the-c-library">The C Library</a></li>
            <li><a href="#source-code">Source Code</a></li>
            <li><a href="#programming-flow">Programming Flow</a></li>
            <li><a href="#using-the-library">Using the Library</a></li>
            <li><a href="#example">Example</a></li>
            <li><a href="#functions">Functions</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="i2c-c-library">I2C C Library</h1>
<p>The Onion I2C Library, <code>libonioni2c</code> is a dynamic C library that provides functions to easily read from and write to devices communicating with the Omega via I2C. The library can be used in C and C++ programs.</p>
<p>Also available is a Python module that implements an I2C object using functions from the C library. The module is called <code>onionI2C</code> and is part of the <code>OmegaExpansion</code> package.</p>
<p>[[<em>TOC</em>]]</p>
<h1 id="linux-and-i2c">Linux and I2C</h1>
<p>I2C devices are usually controlled by a kernel driver, however, it is also possible to access devices through an adapter in the Linux filesystem. The adapter can be found at <code>/dev/i2c-X</code>, where <code>X</code> is the adapter number which can range from 0 to 255. On the Omega, <code>/dev/i2c-0</code> is available by default. This allows users to interact with I2C slaves from the Linux environment.</p>
<p>The Onion I2C library uses the <code>/dev/i2c-0</code> adapter, and implements read and write functions I2C devices.</p>
<h1 id="the-c-library">The C Library</h1>
<p>The <code>libonioni2c</code> C library is a series of functions that implement I2C communication through the Linux device interface. </p>
<h2 id="source-code">Source Code</h2>
<p>The source code can be found in the <a href="https://github.com/OnionIoT/i2c-exp-driver">Onion <code>i2c-exp-driver</code> GitHub Repo</a>.</p>
<h2 id="programming-flow">Programming Flow</h2>
<p>Each of the read and write functions have been written to be self-contained, so one function call will complete the desired action.</p>
<h2 id="using-the-library">Using the Library</h2>
<p><strong>Header File</strong></p>
<p>To add the Onion I2C Library to your C/C++ program, include the header file in your C code:</p>
<pre><code class="c">#include &lt;onion-i2c.h&gt;
</code></pre>

<p><strong>Library for Linker</strong></p>
<p>In your project's makefile, you will need to add the following dynamic libraries to the linker command:</p>
<pre><code class="c">-loniondebug -lonioni2c 
</code></pre>

<p>The dynamic libraries are stored in <code>/usr/lib</code> on the Omega.</p>
<h2 id="example">Example</h2>
<p>An example of how the <code>libonioni2c</code> library is used can be found in the GitHub Repo for the drivers for the <a href="https://github.com/OnionIoT/i2c-exp-driver">PWM, Relay, and OLED Expansions</a>.</p>
<p>Specifically, a variety of functions are used in the <a href="https://github.com/OnionIoT/i2c-exp-driver/blob/master/src/pwm-exp.c">PWM Expansion source code</a>.</p>
<h2 id="functions">Functions</h2>
<p>Each of the main functions implemented in this library are described below.</p>
<h3 id="function-flow">Function Flow</h3>
<p>All of the functions follow the same general pattern:
* Get a file descriptor to the I2C adapter
* Inform the adapter which device to communicate with
* Perform the function's main operation (read, write to the I2C adapter)
* Release the I2C adapter device handle
* Return the function status</p>
<h3 id="return-values">Return Values</h3>
<p>All functions follow the same pattern with return values:</p>
<p>If the function operation is successful, the return value will be <code>EXIT_SUCCESS</code> which is a macro defined as <code>0</code> in <code>cstdlib.h.</code></p>
<p>If the function operation is not successful, the function will return <code>EXIT_FAILURE</code> which is defined as <code>1</code>. </p>
<p>A few reasons why the function might not be successful:
* The specified device address cannot be found on the I2C bus
* The system I2C interface is currently in use elsewhere</p>
<p>An error message will be printed that will give more information on the reason behind the failure.</p>
<h3 id="read-functions">Read Functions</h3>
<p>Functions that perform reads from devices on the I2C bus</p>
<h4 id="function-i2c_readbyte">Function: <code>i2c_readByte</code></h4>
<p>The <code>i2c_readByte</code> function will read one byte from a register address on a specified device on the I2C bus.</p>
<p>The function is declared as follows:</p>
<pre><code class="c">int i2c_readByte (int devNum, int devAddr, int addr, int *val);
</code></pre>

<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>devNum</td>
<td>Omega I2C adapter number</td>
</tr>
<tr>
<td>devAddr</td>
<td>I2C device address</td>
</tr>
<tr>
<td>addr</td>
<td>Device register to access</td>
</tr>
<tr>
<td>*val</td>
<td>Returns: read value</td>
</tr>
</tbody>
</table>
<p>The adapter number on the Omega should always be 0 since it will use <code>/dev/i2c-0</code> to interface with I2C devices. The I2C device address is unique to each type of device and can be found in the device datasheet. The datasheet will also define register addresses to read specific data. </p>
<p>Finally, the val argument is passed by reference, and after the function runs will contain the single byte that was read.</p>
<p><strong>Examples</strong></p>
<p>To read a byte from the 0x01 register from an I2C device with address of 0x5a (the Servo Expansion):</p>
<pre><code class="c">int     status, rdByte;
status  = i2c_write(0, 0x5a, 0x01, &amp;rdByte);
</code></pre>

<h4 id="function-i2c_read">Function: <code>i2c_read</code></h4>
<p>The <code>i2c_read</code> function will read a specified number of bytes from a register address on a device on the I2C bus.</p>
<p>The function is declared as follows:</p>
<pre><code class="c">int i2c_read (int devNum, int devAddr, int addr, uint8_t *buffer, int numBytes);
</code></pre>

<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>devNum</td>
<td>Omega I2C adapter number</td>
</tr>
<tr>
<td>devAddr</td>
<td>I2C device address</td>
</tr>
<tr>
<td>addr</td>
<td>Device register to access</td>
</tr>
<tr>
<td>*buffer</td>
<td>Pointer that will contain the bytes read</td>
</tr>
<tr>
<td>numBytes</td>
<td>Number of bytes to read</td>
</tr>
</tbody>
</table>
<p>The adapter number on the Omega should always be 0 since it will use <code>/dev/i2c-0</code> to interface with I2C devices. The I2C device address is unique to each type of device and can be found in the device datasheet. The datasheet will also define register addresses to read specific data. </p>
<p>The <code>numBytes</code> argument specifies how many bytes to read from a specific address on the I2C device. 
The <code>*buffer</code> argument is a unsigned 8-bit integer pointer that will contain all of the bytes read from the device once the function returns</p>
<p>Note that when using a pointer for the <code>buffer</code> argument, it must be allocated before being passed into the function, and it must be allocated with at least the number specified by <code>numBytes</code>. When using an array for the buffer, it must be declared with at least the number of elements specified by the numBytes argument.</p>
<p><strong>C Examples</strong></p>
<p>To read 4 bytes from address 0x00 on a device with an address of 0x48, using a pointer for the buffer:</p>
<pre><code class="c">int     status;
uint8_t *buffer = malloc(4 * sizeof *buffer);
status          = i2c_read(0, 0x48, 0x00, buffer, 4);
</code></pre>

<p>To read 2 bytes from address 0x10 on a device with an address of 0x48, using an array for the buffer:</p>
<pre><code class="c">int     status;
uint8_t buffer[32];
status          = i2c_read(0, 0x48, 0x10, buffer, 2);
</code></pre>

<p><strong>C++ Examples</strong></p>
<p>To read 2 bytes from address 0x00 on a device with an address of 0x48, using a pointer for the buffer:</p>
<pre><code class="c++">int     status;
uint8_t *buffer = new uint8_t[16];
status          = i2c_read(0, 0x48, 0x00, buffer, 2);
</code></pre>

<h3 id="write-functions">Write Functions</h3>
<p>Functions that perform writes to devices on the I2C bus.</p>
<h4 id="function-i2c_writebuffer">Function: <code>i2c_writeBuffer</code></h4>
<p>The <code>i2c_writeBuffer</code> function will write a specified number of bytes from a previously populated pointer or array to a register address on an I2C device.</p>
<p>The function is declared as follows:</p>
<pre><code class="c">int i2c_writeBuffer (int devNum, int devAddr, int addr, uint8_t *buffer, int size);
</code></pre>

<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>devNum</td>
<td>Omega I2C adapter number</td>
</tr>
<tr>
<td>devAddr</td>
<td>I2C device address</td>
</tr>
<tr>
<td>addr</td>
<td>Device register to access</td>
</tr>
<tr>
<td>*buffer</td>
<td>Bytes to be written to the device</td>
</tr>
<tr>
<td>size</td>
<td>Number of bytes to be written</td>
</tr>
</tbody>
</table>
<p>The adapter number on the Omega should always be 0 since it will use <code>/dev/i2c-0</code> to interface with I2C devices. The I2C device address is unique to each type of device and can be found in the device datasheet. The datasheet will also define register addresses to read specific data. </p>
<p>The <code>size</code> argument is the number of bytes to write from the buffer pointer. The <code>*buffer</code> argument is a unsigned 8-bit integer pointer that contains all of the bytes to be written to the specified address on the I2C device. Note that <code>buffer[0]</code> will be written first, and then <code>buffer[1]</code>, and so on.</p>
<p>When using a pointer for the <code>buffer</code> argument, it must be allocated and populated before being passed into the function, and it must be allocated with at least the number specified by <code>size</code>. When using an array for the buffer, it must be declared with at least the number of elements specified by the numBytes argument.</p>
<p><strong>Examples</strong></p>
<p>Write 2 bytes to the 0x02 register address on an I2C device with an address of 0x08, <em>using an array for the <code>buffer</code> argument</em>:</p>
<pre><code class="c">int     status;
uint8_t buffer[32];

// populate the buffer
buffer[0]   = 0xde;
buffer[1]   = 0xad;

status      = i2c_writeBuffer(0, 0x08, 0x01, buffer, 2);
</code></pre>

<p>Write 3 bytes to the 0x05 register address on the same device as above using an array for the <code>buffer</code> argument:</p>
<pre><code class="c">int     status;
uint8_t buffer[3] = {0xbe, 0xef, 0x80};

status      = i2c_writeBuffer(0, 0x08, 0x05, buffer, 3);
</code></pre>

<p>Write 4 bytes to the 0x54 register address on an I2C device with an address of 0x30, *using a pointer for the <code>buffer</code> argument:</p>
<pre><code class="c">int     status;
uint8_t *buffer = malloc(4 * sizeof *buffer);

// populate the buffer
buffer[0]   = 0xb6;
buffer[1]   = 0xd1;
buffer[2]   = 0xe3;
buffer[3]   = 0xff;

status      = i2c_writeBuffer(0, 0x30, 0x54, buffer, 4);
</code></pre>

<h4 id="function-i2c_writebytes">Function: <code>i2c_writeBytes</code></h4>
<p>The <code>i2c_writeBytes</code> function will write a specified number of bytes from an integer variable to an address on an I2C device. Sometimes it's a little quicker to pass in an integer rather than create a buffer like the <code>i2c_writeBuffer</code> function above requires. Note that the Least Significant Byte (LSB) of the integer will be written first and that the maximum number of bytes is 4 (since an int holds 32 bits on the Omega).</p>
<p>The function is declared as follows:</p>
<pre><code class="c">int i2c_writeBytes  (int devNum, int devAddr, int addr, int val, int numBytes);
</code></pre>

<p><strong>Arguments</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td>devNum</td>
<td>Omega I2C adapter number</td>
</tr>
<tr>
<td>devAddr</td>
<td>I2C device address</td>
</tr>
<tr>
<td>addr</td>
<td>Device register to access</td>
</tr>
<tr>
<td>val</td>
<td>Integer to be written</td>
</tr>
<tr>
<td>numBytes</td>
<td>Number of bytes to be written</td>
</tr>
</tbody>
</table>
<p>The adapter number on the Omega should always be 0 since it will use <code>/dev/i2c-0</code> to interface with I2C devices. The I2C device address is unique to each type of device and can be found in the device datasheet. The datasheet will also define register addresses to read specific data. </p>
<p>The <code>numBytes</code> argument is the number of bytes to write from the integer. The <code>val</code> argument is an integer variable that should be preprogrammed with a value to be written. </p>
<p>Note that the bytes of the integer will be written in the following order, assuming that 4 bytes are being written:
* val[7:0]
* val[15:8]
* val[23:16]
* val[31:14]</p>
<p><strong>Examples</strong></p>
<p>Write a byte to the 0x02 register address on an I2C device with an address of 0x08:</p>
<pre><code class="c">int     status;
int     val     = 0x04;

status      = i2c_writeBytes(0, 0x08, 0x01, val, 1);
</code></pre>

<p>Write 2 bytes to the 0x05 register address on the same device as above:</p>
<pre><code class="c">int     status;
int     val     = 0x1304;

// write 0x04 and then 0x13 to the 0x01 address
status      = i2c_writeBytes(0, 0x08, 0x01, val, 2);

</code></pre>

<p>Write 3 bytes to the 0x54 register address on an I2C device with an address of 0x30:</p>
<pre><code class="c">int     status;
int     val     = 0xfe082324;

// write 0x24, then 0x23, and then 0x08 to the 0x54 address
status      = i2c_writeBytes(0, 0x30, 0x54, val, 3);
</code></pre>

<p>Write 4 bytes to the 0x00 register address on an I2C device with an address of 0x30:</p>
<pre><code class="c">int     status;
int     val     = 0x27f8e460;

// write 0x60, then 0xe4, then 0xf8, and then 0x27 to the 0x00 address
status      = i2c_writeBytes(0, 0x30, 0x00, val, 4);
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../../../..",
                shortcuts = {"search": 83, "next": 78, "help": 191, "previous": 80};
        </script>
        <script src="../../../../../js/base.js" defer></script>
        <script src="../../../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
